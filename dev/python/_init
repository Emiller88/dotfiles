#!/usr/bin/env zsh
source ${0:A:h}/../../deploy
source env.zsh

install() {
  _ensure_repo pyenv/pyenv $PYENV_ROOT
  _ensure_repo esc/conda-zsh-completion $CONDAZSH_ROOT
  wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
  bash Miniconda3-latest-Linux-x86_64.sh
}

update() {
  if [[ -n $PYENV_ROOT ]]; then
    cd $PYENV_ROOT && git pull
    for ver in $PYENV_ROOT/plugins/*(/N); do
      cd $ver && git pull
    done
  fi
}

link() {
  mklink config/flake8 $XDG_CONFIG_HOME/
}

clean() {
  rm -fv $XDG_CONFIG_HOME/flake8
  rm -rfv $PYENV_ROOT
}

init "$@"
